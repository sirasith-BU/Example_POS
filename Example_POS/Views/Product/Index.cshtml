@using Example_POS.DTOs.Category;
@* @model IEnumerable<CategoryDTO> *@
@{
    ViewData["Title"] = "Product";
}

<h5>Add Product</h5>
<div class="bg-dark p-2" style="border-radius:10px;">
    <form id="productForm">
        <div class="row text-light">
            <div class="col">
                <label class="form-label">Category</label>
                <select class="form-select" aria-label="Default select example" id="cat-select">
                    <option selected>Select Category</option>
                    @* @foreach (var category in cat)
                {
                    <option value="@category.Name">@category.Name</option>
                } *@
                </select>
            </div>
            <div class="col">
                <label class="form-label">Name</label>
                <input class="form-control" type="text" name="name" placeholder="Enter name" />
            </div>
            <div class="col">
                <label class="form-label">Quantity</label>
                <input class="form-control" type="number" name="quantity" placeholder="Enter quantity" />
            </div>
            <div class="col">
                <label class="form-label">Price</label>
                <input class="form-control" type="text" name="price" placeholder="Enter Price" />
            </div>
            <div class="col-4">
                <label class="form-label">Description</label>
                <input class="form-control" type="text" name="description" placeholder="Enter description" />
            </div>
            <div class="col d-flex flex-column justify-content-end">
                <button type="submit" class="btn btn-primary">Create</button>
            </div>
        </div>
    </form>
</div>

<div class="mt-3">
    <label class="form-label">Search</label>
    <input class="form-control" type="text" placeholder="Search by Product name and description"/>
</div>

<h1 class="mt-3">Products</h1>
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Description</th>
            <th>CategoryId</th>
            <th>CategoryName</th>
            <th>Edit</th>
            <th>Delete</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td><button class="btn btn-warning">Edit</button></td>
            <td><button class="btn btn-danger">Delete</button></td>
        </tr>
    </tbody>
</table>

@section Scripts {
    <script>
        let categoryOptions = []

        // Get Category Options
        $(document).ready(function () {
            $.ajax({
                type: 'GET',
                url: '/Category/CatagoryOptions',
                success: (response) => {
                    categoryOptions = response;
                    console.log(response);

                    categoryOptions.forEach(cat_ => {
                        $('#cat-select').append(`
                            <option class="cat-val" value="${cat_.id}">${cat_.name}</option>
                        `);
                    });
                },
                error: function (xhr, status, error) {
                    alert("Error occurred: " + xhr.responseText);
                }
            });
        });

        // Create
        $('#productForm').on('submit', function (e) {
            e.preventDefault();

            const cat_ = $('option.cat-val').val();
            const name = $('input[name="name"]').val();
            const quantity = $('input[name="quantity"]').val();
            const price = $('input[name="price"]').val();
            const description = $('input[name="description"]').val();
        });
    </script>
}